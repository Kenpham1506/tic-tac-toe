<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tic Tac Toe - Peer to Peer</title>
    <script src="https://unpkg.com/simple-peer@9/simplepeer.min.js"></script>
</head>
<body>
    <h1>Tic Tac Toe - Peer to Peer</h1>

    <!-- Display for Signaling Code -->
    <div id="signal-display" style="margin-bottom: 20px;">
        <h2>Your Signaling Code:</h2>
        <textarea id="signal-code" rows="10" cols="50" readonly></textarea>
        <button onclick="copySignalCode()">Copy to Clipboard</button>
    </div>

    <!-- Input for the Opponent's Signaling Code -->
    <div id="opponent-signal">
        <h2>Enter Opponent's Signaling Code:</h2>
        <textarea id="opponent-code" rows="10" cols="50"></textarea>
        <button onclick="connect()">Connect</button>
    </div>

    <!-- Tic Tac Toe Board (Placeholder) -->
    <div id="game-board">
        <!-- Game Board will be implemented here -->
    </div>

    <script>
        let peer;
        const signalCodeArea = document.getElementById('signal-code');

        function setupConnection(isInitiator) {
            peer = new SimplePeer({ initiator: isInitiator });

            peer.on('signal', data => {
                signalCodeArea.value = JSON.stringify(data);
            });

            peer.on('connect', () => {
                alert('Connection established!');
                // Hide signaling sections once connected
                document.getElementById('signal-display').style.display = 'none';
                document.getElementById('opponent-signal').style.display = 'none';
                // Initialize the game board or start the game
            });

            peer.on('data', data => {
                console.log('Received:', data.toString());
                // Handle incoming data (e.g., game moves)
            });
        }

        function copySignalCode() {
            signalCodeArea.select();
            document.execCommand('copy');
            alert('Signaling code copied to clipboard!');
        }

        function connect() {
            const opponentCode = document.getElementById('opponent-code').value;
            if (opponentCode) {
                peer.signal(JSON.parse(opponentCode));
            } else {
                alert('Please enter the opponent\'s signaling code.');
            }
        }

        // Start as the first player (initiator)
        setupConnection(true);

        // Later, you can implement a button or prompt for the second player to call setupConnection(false).
    </script>
</body>
</html>
